---
id: 343
title: 'Simple Java *nix shell (Proof of Concept)'
date: 2012-08-23T22:26:54-04:00
author: brad
layout: post
guid: http://br4d.net/?p=343
permalink: /simple-java-nix-shell-proof-of-concept/
categories:
  - Java
  - Programming
---
This is a very simple shell interface with a built-in history feature for use in your favorite *nix environment. This small project comes from a project in my Operating Systems class at Marshall University in which we were studying message passing models in modern OSs.

It should work fine with any program that is defined in your system $PATH variable (usually /usr/bin, etc). If you type !!, it will re-run the previous command. Or n!, where n is the number of the previous command. To get a list of these previous commands and their corresponding numbers, use the ‘history’ command which will show you all of your previous entries.

<div class="codecolorer-container java default">
  <div class="java codecolorer">
    <span class="coMULTI">/*<br />  * Simple java shell with history feature<br />  * @author bradley carey<br />  * @date September 26, 2011<br />  */</span><br />  <br /> <span class="kw1">import</span> <span class="co2">java.io.*</span><span class="sy0">;</span><br /> <span class="kw1">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span><br /> <span class="kw1">import</span> <span class="co2">java.lang.ProcessBuilder</span><span class="sy0">;</span><br />  <br /> <span class="kw1">public</span> <span class="kw1">class</span> SimpleShell <span class="br0">{</span><br />     <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> main<span class="br0">(</span><a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="kw1">throws</span> java.<span class="me1">io</span>.<a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+ioexception"><span class="kw3">IOException</span></a><br />     <span class="br0">{</span><br />         <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a> commandLine, delims <span class="sy0">=</span> <span class="st0">"[ ]+"</span>, pwd<span class="sy0">;</span><br />         ArrayList<span class="sy0"><</span>String<span class="sy0">></span> history <span class="sy0">=</span> <span class="kw1">new</span> ArrayList<span class="sy0"><</span>String<span class="sy0">></span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span><br />  <br />         <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+bufferedreader"><span class="kw3">BufferedReader</span></a> console <span class="sy0">=</span> <span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+bufferedreader"><span class="kw3">BufferedReader</span></a><span class="br0">(</span><span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+inputstreamreader"><span class="kw3">InputStreamReader</span></a><span class="br0">(</span><a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">in</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br />  <br />         pwd <span class="sy0">=</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">getProperty</span><span class="br0">(</span><span class="st0">"user.home"</span><span class="br0">)</span><span class="sy0">;</span><br />  <br />         <span class="kw1">while</span> <span class="br0">(</span><span class="kw2">true</span><span class="br0">)</span><br />         <span class="br0">{</span><br />             <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span><span class="st0">"jsh@"</span> <span class="sy0">+</span> pwd <span class="sy0">+</span> <span class="st0">">"</span><span class="br0">)</span><span class="sy0">;</span><br />             commandLine <span class="sy0">=</span> console.<span class="me1">readLine</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span><br />  <br />             <span class="kw1">if</span><span class="br0">(</span>commandLine.<span class="me1">equals</span><span class="br0">(</span><span class="st0">""</span><span class="br0">)</span><span class="br0">)</span><br />                 <span class="kw1">continue</span><span class="sy0">;</span><br />  <br />             <span class="kw1">if</span><span class="br0">(</span>commandLine.<span class="me1">equals</span><span class="br0">(</span><span class="st0">"exit"</span><span class="br0">)</span><span class="br0">)</span><br />                 <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">exit</span><span class="br0">(</span><span class="nu0"></span><span class="br0">)</span><span class="sy0">;</span><br />  <br />             <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a><span class="br0">[</span><span class="br0">]</span> tokens <span class="sy0">=</span> commandLine.<span class="me1">split</span><span class="br0">(</span>delims<span class="br0">)</span><span class="sy0">;</span><br />             <span class="kw1">for</span> <span class="br0">(</span><a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a> s<span class="sy0">:</span> tokens<span class="br0">)</span><br />             <span class="br0">{</span><br />                 <span class="co1">//currentCommand.add(s);</span><br />                 <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"tokens:"</span> <span class="sy0">+</span> s<span class="br0">)</span><span class="sy0">;</span><br />             <span class="br0">}</span><br />             history.<span class="me1">add</span><span class="br0">(</span>commandLine<span class="br0">)</span><span class="sy0">;</span><br />             <span class="kw1">if</span><span class="br0">(</span>commandLine.<span class="me1">equals</span><span class="br0">(</span><span class="st0">"history"</span><span class="br0">)</span><span class="br0">)</span><br />             <span class="br0">{</span><br />                 <span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> i<span class="sy0">=</span><span class="nu0"></span><span class="sy0">;</span> i <span class="sy0"><</span> history.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span><br />                     <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"["</span> <span class="sy0">+</span> i <span class="sy0">+</span> <span class="st0">"] "</span> <span class="sy0">+</span> history.<span class="me1">get</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br />                 <span class="kw1">continue</span><span class="sy0">;</span><br />             <span class="br0">}</span><br />  <br />             <span class="kw1">if</span><span class="br0">(</span>commandLine.<span class="me1">charAt</span><span class="br0">(</span><span class="nu0"></span><span class="br0">)</span> <span class="sy0">==</span> <span class="st0">'!'</span><span class="br0">)</span><br />             <span class="br0">{</span><br />                 <span class="kw4">char</span> which <span class="sy0">=</span> commandLine.<span class="me1">charAt</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span><span class="sy0">;</span><br />                 <span class="kw1">if</span><span class="br0">(</span>which<span class="sy0">==</span><span class="st0">'!'</span><span class="br0">)</span> <span class="co1">// !! entered, print previous command</span><br />                 <span class="br0">{</span><br />                     <span class="kw1">if</span><span class="br0">(</span>history.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span> <span class="sy0">></span> <span class="nu0">2</span><span class="br0">)</span><br />                     <span class="br0">{</span><br />                         <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a> toRun <span class="sy0">=</span> history.<span class="me1">get</span><span class="br0">(</span>history.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">-</span><span class="nu0">2</span><span class="br0">)</span><span class="sy0">;</span><br />                         tokens <span class="sy0">=</span> toRun.<span class="me1">split</span><span class="br0">(</span>delims<span class="br0">)</span><span class="sy0">;</span><br />                         <span class="kw1">for</span> <span class="br0">(</span><a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a> s<span class="sy0">:</span> tokens<span class="br0">)</span><br />                             <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>s<span class="br0">)</span><span class="sy0">;</span><br />  <br />                     <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span><br />                         <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Error: unable to run previous command!"</span><span class="br0">)</span><span class="sy0">;</span><br />                         <span class="kw1">continue</span><span class="sy0">;</span><br />                     <span class="br0">}</span><br />                 <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span> <span class="co1">// !n, run nth command</span><br />                     <span class="kw4">int</span> whichNum <span class="sy0">=</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+integer"><span class="kw3">Integer</span></a>.<span class="me1">parseInt</span><span class="br0">(</span><a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+character"><span class="kw3">Character</span></a>.<span class="me1">toString</span><span class="br0">(</span>which<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br />                     <span class="kw1">if</span><span class="br0">(</span>history.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span> <span class="sy0">></span> whichNum<span class="br0">)</span><br />                     <span class="br0">{</span><br />                         <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a> toRun <span class="sy0">=</span> history.<span class="me1">get</span><span class="br0">(</span>whichNum<span class="br0">)</span><span class="sy0">;</span><br />                         tokens <span class="sy0">=</span> toRun.<span class="me1">split</span><span class="br0">(</span>delims<span class="br0">)</span><span class="sy0">;</span><br />                         <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>toRun<span class="br0">)</span><span class="sy0">;</span><br />                     <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span><br />                         <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Error: unable to run history command. Out of bounds error?"</span><span class="br0">)</span><span class="sy0">;</span><br />                         <span class="kw1">continue</span><span class="sy0">;</span><br />                     <span class="br0">}</span><br />                 <span class="br0">}</span><br />             <span class="br0">}</span><br />  <br />             <span class="kw1">if</span><span class="br0">(</span>commandLine.<span class="me1">equals</span><span class="br0">(</span><span class="st0">"cd"</span><span class="br0">)</span><span class="br0">)</span><br />             <span class="br0">{</span><br />                 pwd <span class="sy0">=</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">getProperty</span><span class="br0">(</span><span class="st0">"user.home"</span><span class="br0">)</span><span class="sy0">;</span><br />                 <span class="kw1">continue</span><span class="sy0">;</span><br />             <span class="br0">}</span><br />  <br />             <span class="kw1">if</span><span class="br0">(</span>tokens<span class="br0">[</span><span class="nu0"></span><span class="br0">]</span>.<span class="me1">equals</span><span class="br0">(</span><span class="st0">"cd"</span><span class="br0">)</span><span class="br0">)</span><br />             <span class="br0">{</span><br />                 <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a> changeTo <span class="sy0">=</span> tokens<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">;</span><br />                 <span class="kw1">if</span><span class="br0">(</span>changeTo.<span class="me1">contains</span><span class="br0">(</span><span class="st0">"/"</span><span class="br0">)</span><span class="br0">)</span> <span class="co1">// absolute path</span><br />                 <span class="br0">{</span><br />                     <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+file"><span class="kw3">File</span></a> tempFile <span class="sy0">=</span> <span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+file"><span class="kw3">File</span></a><span class="br0">(</span>tokens<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span><br />                     <span class="kw1">if</span><span class="br0">(</span><span class="sy0">!</span>tempFile.<span class="me1">exists</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="co1">// file doesnt exist, abort</span><br />                     <span class="br0">{</span><br />                         <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Error: invalid directory specified"</span><span class="br0">)</span><span class="sy0">;</span><br />                         <span class="kw1">continue</span><span class="sy0">;</span><br />                     <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span> <span class="co1">// file exists, change dir</span><br />                         pwd <span class="sy0">=</span> tokens<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">;</span><br />                     <span class="br0">}</span><br />                 <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span> <span class="co1">// relative path</span><br />                     <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>pwd <span class="sy0">+</span> <span class="st0">"/"</span> <span class="sy0">+</span> tokens<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span><br />                     <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+file"><span class="kw3">File</span></a> tempFile <span class="sy0">=</span> <span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+file"><span class="kw3">File</span></a><span class="br0">(</span>pwd <span class="sy0">+</span> <span class="st0">"/"</span> <span class="sy0">+</span> tokens<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span><br />                     <span class="kw1">if</span><span class="br0">(</span><span class="sy0">!</span>tempFile.<span class="me1">exists</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><br />                     <span class="br0">{</span><br />                         <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Error: invalid directory specified"</span><span class="br0">)</span><span class="sy0">;</span><br />                         <span class="kw1">continue</span><span class="sy0">;</span><br />                     <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span><br />                         pwd <span class="sy0">=</span> pwd <span class="sy0">+</span> <span class="st0">"/"</span> <span class="sy0">+</span> tokens<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">;</span><br />                     <span class="br0">}</span><br />                 <span class="br0">}</span><br />                 <span class="kw1">continue</span><span class="sy0">;</span><br />             <span class="br0">}</span><br />  <br />             <span class="kw1">try</span><br />             <span class="br0">{</span><br />                 ProcessBuilder newProcess <span class="sy0">=</span> <span class="kw1">new</span> ProcessBuilder<span class="br0">(</span>tokens<span class="br0">)</span><span class="sy0">;</span><br />                 newProcess.<span class="me1">directory</span><span class="br0">(</span><span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+file"><span class="kw3">File</span></a><span class="br0">(</span>pwd<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br />                 <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+process"><span class="kw3">Process</span></a> current <span class="sy0">=</span> newProcess.<span class="me1">start</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span><br />                 current.<span class="me1">waitFor</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// create new process and wait for execution to finish</span><br />  <br />                 <span class="co1">// print output</span><br />                 <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+bufferedreader"><span class="kw3">BufferedReader</span></a> is <span class="sy0">=</span> <span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+bufferedreader"><span class="kw3">BufferedReader</span></a><span class="br0">(</span><span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+inputstreamreader"><span class="kw3">InputStreamReader</span></a><span class="br0">(</span>current.<span class="me1">getInputStream</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br />                 <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+string"><span class="kw3">String</span></a> line<span class="sy0">;</span><br />                 <span class="kw1">while</span> <span class="br0">(</span><span class="br0">(</span>line <span class="sy0">=</span> is.<span class="me1">readLine</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">)</span><br />                     <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>line<span class="br0">)</span><span class="sy0">;</span><br />  <br />                 <span class="co1">// print errors</span><br />                 is <span class="sy0">=</span> <span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+bufferedreader"><span class="kw3">BufferedReader</span></a><span class="br0">(</span><span class="kw1">new</span> <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+inputstreamreader"><span class="kw3">InputStreamReader</span></a><span class="br0">(</span>current.<span class="me1">getErrorStream</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span><br />                 <span class="kw1">while</span> <span class="br0">(</span><span class="br0">(</span>line <span class="sy0">=</span> is.<span class="me1">readLine</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">)</span><br />                     <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>line<span class="br0">)</span><span class="sy0">;</span><br />             <span class="br0">}</span> <span class="kw1">catch</span><span class="br0">(</span><a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+ioexception"><span class="kw3">IOException</span></a> e<span class="br0">)</span> <span class="br0">{</span><br />                 <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Error: IOException has occurred. Command invalid?"</span><span class="br0">)</span><span class="sy0">;</span><br />             <span class="br0">}</span> <span class="kw1">catch</span><span class="br0">(</span><a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+interruptedexception"><span class="kw3">InterruptedException</span></a> e2<span class="br0">)</span> <span class="br0">{</span><br />                 <a href="http://www.google.com/search?hl=en&q=allinurl%3Adocs.oracle.com+javase+docs+api+system"><span class="kw3">System</span></a>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Error: InterruptedException has occurred"</span><span class="br0">)</span><span class="sy0">;</span><br />             <span class="br0">}</span><br />         <span class="br0">}</span> <span class="co1">// end while loop</span><br />     <span class="br0">}</span><br /> <span class="br0">}</span>
  </div>
</div>